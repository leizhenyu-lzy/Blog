#!/bin/bash

# 接收第一个命令行参数作为要检测的数字
num=$1

# --- 1. 输入验证 ---

# 检查用户是否提供了参数
if [ -z "$num" ]; then
    echo "用法: $0 <数字>"
    echo "示例: $0 17"
    exit 1
fi

# 检查输入是否为正整数 (使用正则表达式)
# 这会处理掉非数字、负数和小数
if ! [[ "$num" =~ ^[0-9]+$ ]]; then
    echo "错误: '$num' 不是一个有效的正整数。"
    exit 1
fi

# --- 2. 素数逻辑判断 ---

# 素数的定义是大于1的自然数
# 所以 0 和 1 都不是素数
if (( num < 2 )); then
    echo "$num 不是素数。"
    exit 0
fi

# --- 3. 循环检测因子 ---

# 算法核心：
# 我们只需要检测从 2 到 sqrt(num)（num的平方根） 之间的数
# (i * i <= num) 是 (i <= sqrt(num)) 的整数等价形式，避免了浮点运算
#
# 为什么？
# 如果 num 有一个大于 sqrt(num) 的因子（称之为 a），
# 那么它必定有另一个小于 sqrt(num) 的因子（称之为 b），
# 因为 a * b = num。
#
# 例如：检查 36 (sqrt(36) = 6)
# 因子有 (2, 18), (3, 12), (4, 9), (6, 6)
# 我们只需要找到 2, 3, 4 或 6 就可以停止了。
#
# 特例：如果输入是 2，(i=2; 2*2 <= 2) 为 false，循环不执行，
# 脚本会直接跳到最后，正确地报告 "2 是素数"。

for (( i=2; i*i <= num; i++ )); do

    # 使用 $((...)) 进行算术运算
    # % 是取模（求余数）运算符
    if (( num % i == 0 )); then
        # 如果余数为 0，说明 num 可以被 i 整除
        # 这意味着 num 不是素数
        echo "$num 不是素数 (可以被 $i 整除)。"
        exit 0
    fi
done

# 如果循环正常结束（即没有在中间 exit），
# 说明在 [2, sqrt(num)] 范围内没有找到任何因子
# 因此，这个数是素数
echo "$num 是素数。"
exit 0